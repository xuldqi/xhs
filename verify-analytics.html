<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Analytics éªŒè¯å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 800px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .section {
      margin-bottom: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .section h2 {
      color: #333;
      font-size: 18px;
      margin-bottom: 15px;
    }

    .status {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
      background: white;
    }

    .status.success {
      border-left: 4px solid #10b981;
    }

    .status.error {
      border-left: 4px solid #ef4444;
    }

    .status.warning {
      border-left: 4px solid #f59e0b;
    }

    .icon {
      font-size: 24px;
    }

    .info {
      flex: 1;
    }

    .label {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }

    .value {
      color: #666;
      font-size: 14px;
      font-family: 'Courier New', monospace;
    }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
      margin-right: 10px;
    }

    button:hover {
      transform: translateY(-2px);
    }

    button:active {
      transform: translateY(0);
    }

    .code-block {
      background: #1e293b;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      overflow-x: auto;
      margin: 10px 0;
    }

    .instructions {
      background: #fef3c7;
      border: 1px solid #fbbf24;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
    }

    .instructions h3 {
      color: #92400e;
      margin-bottom: 10px;
      font-size: 16px;
    }

    .instructions ol {
      margin-left: 20px;
      color: #78350f;
    }

    .instructions li {
      margin: 5px 0;
    }

    .event-log {
      max-height: 300px;
      overflow-y: auto;
      background: white;
      padding: 15px;
      border-radius: 8px;
      margin-top: 10px;
    }

    .event-item {
      padding: 8px;
      margin: 5px 0;
      background: #f1f5f9;
      border-radius: 4px;
      font-size: 13px;
    }

    .timestamp {
      color: #64748b;
      font-size: 11px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” Google Analytics éªŒè¯å·¥å…·</h1>
    <p class="subtitle">æ£€æŸ¥ GA4 é…ç½®å’Œäº‹ä»¶è¿½è¸ª</p>

    <!-- GA é…ç½®çŠ¶æ€ -->
    <div class="section">
      <h2>ğŸ“Š GA4 é…ç½®çŠ¶æ€</h2>
      <div id="ga-status"></div>
    </div>

    <!-- æµ‹è¯•æŒ‰é’® -->
    <div class="section">
      <h2>ğŸ§ª æµ‹è¯•äº‹ä»¶è¿½è¸ª</h2>
      <button onclick="testPageView()">æµ‹è¯•é¡µé¢æµè§ˆ</button>
      <button onclick="testCustomEvent()">æµ‹è¯•è‡ªå®šä¹‰äº‹ä»¶</button>
      <button onclick="testConversion()">æµ‹è¯•è½¬åŒ–äº‹ä»¶</button>
      
      <div class="event-log" id="event-log">
        <div style="color: #64748b; text-align: center;">ç­‰å¾…äº‹ä»¶...</div>
      </div>
    </div>

    <!-- ä½¿ç”¨è¯´æ˜ -->
    <div class="instructions">
      <h3>ğŸ“ ä½¿ç”¨è¯´æ˜</h3>
      <ol>
        <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰</li>
        <li>åˆ‡æ¢åˆ° "Network" æ ‡ç­¾</li>
        <li>ç­›é€‰ "google-analytics" æˆ– "collect"</li>
        <li>ç‚¹å‡»ä¸Šæ–¹çš„æµ‹è¯•æŒ‰é’®</li>
        <li>æŸ¥çœ‹æ˜¯å¦æœ‰è¯·æ±‚å‘é€åˆ° GA</li>
        <li>åœ¨ GA4 å®æ—¶æŠ¥å‘Šä¸­éªŒè¯äº‹ä»¶</li>
      </ol>
    </div>

    <!-- éªŒè¯æ­¥éª¤ -->
    <div class="section">
      <h2>âœ… éªŒè¯æ­¥éª¤</h2>
      <div class="instructions">
        <h3>åœ¨ Google Analytics ä¸­éªŒè¯</h3>
        <ol>
          <li>è®¿é—® <a href="https://analytics.google.com/" target="_blank">Google Analytics</a></li>
          <li>é€‰æ‹©ä½ çš„å±æ€§</li>
          <li>ç‚¹å‡»å·¦ä¾§èœå•çš„ "å®æ—¶" â†’ "æ¦‚è§ˆ"</li>
          <li>åœ¨æ­¤é¡µé¢ç‚¹å‡»æµ‹è¯•æŒ‰é’®</li>
          <li>åœ¨ GA å®æ—¶æŠ¥å‘Šä¸­åº”è¯¥èƒ½çœ‹åˆ°äº‹ä»¶</li>
        </ol>
      </div>
    </div>
  </div>

  <script>
    // æ£€æŸ¥ GA é…ç½®
    function checkGAStatus() {
      const statusDiv = document.getElementById('ga-status');
      let html = '';

      // æ£€æŸ¥ gtag æ˜¯å¦åŠ è½½
      if (typeof gtag !== 'undefined') {
        html += `
          <div class="status success">
            <span class="icon">âœ…</span>
            <div class="info">
              <div class="label">gtag å‡½æ•°</div>
              <div class="value">å·²åŠ è½½</div>
            </div>
          </div>
        `;
      } else {
        html += `
          <div class="status error">
            <span class="icon">âŒ</span>
            <div class="info">
              <div class="label">gtag å‡½æ•°</div>
              <div class="value">æœªåŠ è½½ - è¯·æ£€æŸ¥ GA è„šæœ¬</div>
            </div>
          </div>
        `;
      }

      // æ£€æŸ¥ dataLayer
      if (typeof window.dataLayer !== 'undefined') {
        html += `
          <div class="status success">
            <span class="icon">âœ…</span>
            <div class="info">
              <div class="label">dataLayer</div>
              <div class="value">å·²åˆå§‹åŒ– (${window.dataLayer.length} é¡¹)</div>
            </div>
          </div>
        `;
      } else {
        html += `
          <div class="status error">
            <span class="icon">âŒ</span>
            <div class="info">
              <div class="label">dataLayer</div>
              <div class="value">æœªåˆå§‹åŒ–</div>
            </div>
          </div>
        `;
      }

      // æ£€æŸ¥ Measurement ID
      const measurementId = getMeasurementId();
      if (measurementId) {
        html += `
          <div class="status success">
            <span class="icon">âœ…</span>
            <div class="info">
              <div class="label">Measurement ID</div>
              <div class="value">${measurementId}</div>
            </div>
          </div>
        `;
      } else {
        html += `
          <div class="status warning">
            <span class="icon">âš ï¸</span>
            <div class="info">
              <div class="label">Measurement ID</div>
              <div class="value">æœªæ‰¾åˆ° - è¯·æ£€æŸ¥ç¯å¢ƒå˜é‡</div>
            </div>
          </div>
        `;
      }

      statusDiv.innerHTML = html;
    }

    // è·å– Measurement ID
    function getMeasurementId() {
      // å°è¯•ä» dataLayer è·å–
      if (window.dataLayer) {
        for (let item of window.dataLayer) {
          if (item[0] === 'config' && item[1]) {
            return item[1];
          }
        }
      }
      return null;
    }

    // æ·»åŠ äº‹ä»¶åˆ°æ—¥å¿—
    function logEvent(eventName, params = {}) {
      const logDiv = document.getElementById('event-log');
      const timestamp = new Date().toLocaleTimeString();
      
      const eventHtml = `
        <div class="event-item">
          <div class="timestamp">${timestamp}</div>
          <div><strong>${eventName}</strong></div>
          <div style="color: #64748b; font-size: 12px;">${JSON.stringify(params)}</div>
        </div>
      `;
      
      if (logDiv.innerHTML.includes('ç­‰å¾…äº‹ä»¶')) {
        logDiv.innerHTML = eventHtml;
      } else {
        logDiv.innerHTML = eventHtml + logDiv.innerHTML;
      }
    }

    // æµ‹è¯•é¡µé¢æµè§ˆ
    function testPageView() {
      if (typeof gtag === 'undefined') {
        alert('GA æœªåŠ è½½ï¼è¯·æ£€æŸ¥é…ç½®ã€‚');
        return;
      }

      const params = {
        page_title: 'Test Page View',
        page_location: window.location.href,
        page_path: '/test-page-view'
      };

      gtag('event', 'page_view', params);
      logEvent('page_view', params);
      
      console.log('âœ… é¡µé¢æµè§ˆäº‹ä»¶å·²å‘é€', params);
      alert('é¡µé¢æµè§ˆäº‹ä»¶å·²å‘é€ï¼\nè¯·åœ¨ GA4 å®æ—¶æŠ¥å‘Šä¸­æŸ¥çœ‹ã€‚');
    }

    // æµ‹è¯•è‡ªå®šä¹‰äº‹ä»¶
    function testCustomEvent() {
      if (typeof gtag === 'undefined') {
        alert('GA æœªåŠ è½½ï¼è¯·æ£€æŸ¥é…ç½®ã€‚');
        return;
      }

      const params = {
        event_category: 'Test',
        event_label: 'Custom Event Test',
        value: 1
      };

      gtag('event', 'test_custom_event', params);
      logEvent('test_custom_event', params);
      
      console.log('âœ… è‡ªå®šä¹‰äº‹ä»¶å·²å‘é€', params);
      alert('è‡ªå®šä¹‰äº‹ä»¶å·²å‘é€ï¼\nè¯·åœ¨ GA4 å®æ—¶æŠ¥å‘Šä¸­æŸ¥çœ‹ã€‚');
    }

    // æµ‹è¯•è½¬åŒ–äº‹ä»¶
    function testConversion() {
      if (typeof gtag === 'undefined') {
        alert('GA æœªåŠ è½½ï¼è¯·æ£€æŸ¥é…ç½®ã€‚');
        return;
      }

      const params = {
        currency: 'CNY',
        value: 99.00,
        transaction_id: 'TEST_' + Date.now()
      };

      gtag('event', 'purchase', params);
      logEvent('purchase', params);
      
      console.log('âœ… è½¬åŒ–äº‹ä»¶å·²å‘é€', params);
      alert('è½¬åŒ–äº‹ä»¶å·²å‘é€ï¼\nè¯·åœ¨ GA4 å®æ—¶æŠ¥å‘Šä¸­æŸ¥çœ‹ã€‚');
    }

    // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥çŠ¶æ€
    window.addEventListener('load', () => {
      setTimeout(checkGAStatus, 1000);
    });
  </script>

  <!-- Google Analytics è„šæœ¬ -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-K0X9LM3VPZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-K0X9LM3VPZ');
  </script>
</body>
</html>
