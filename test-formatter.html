<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Content Formatter æµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f7fa;
    }
    
    .test-section {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
    }
    
    h2 {
      color: #333;
      margin-bottom: 16px;
    }
    
    /* æ ‡é¢˜å±‚çº§æ ·å¼ - æ¸…æ™°çš„è§†è§‰å±‚æ¬¡ */
    .content-h2 {
      font-size: 24px;
      font-weight: 700;
      color: #1a1a1a;
      margin: 32px 0 20px 0;
      padding: 12px 0;
      background: linear-gradient(90deg, #f0f2ff 0%, transparent 100%);
      line-height: 1.4;
    }
    
    .content-h3 {
      font-size: 20px;
      font-weight: 600;
      color: #2c3e50;
      margin: 24px 0 16px 0;
      padding: 8px 0;
      line-height: 1.5;
    }
    
    .content-h4 {
      font-size: 17px;
      font-weight: 600;
      color: #34495e;
      margin: 20px 0 12px 0;
      padding: 0;
      line-height: 1.5;
    }
    
    .input-text {
      width: 100%;
      min-height: 200px;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-family: monospace;
      font-size: 14px;
      margin-bottom: 16px;
    }
    
    button {
      background: #409EFF;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    
    button:hover {
      background: #66b1ff;
    }
    
    .output {
      margin-top: 24px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
    }
    
    /* å¤åˆ¶ GuideView çš„æ ·å¼ */
    .content-block {
      background: #f8f9fa;
      border-left: 4px solid #409EFF;
      border-radius: 8px;
      padding: 20px 24px;
      margin: 16px 0;
    }
    
    .success-block {
      background: linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%);
      border-left-color: #52c41a;
    }
    
    .warning-block {
      background: linear-gradient(135deg, #fff7e6 0%, #fffbf0 100%);
      border-left-color: #faad14;
    }
    
    .info-block {
      background: linear-gradient(135deg, #e6f7ff 0%, #f0f9ff 100%);
      border-left-color: #1890ff;
    }
    
    .block-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }
    
    .block-icon {
      font-size: 1.4rem;
    }
    
    .block-title {
      font-size: 1.05rem;
      font-weight: 600;
      color: #333;
    }
    
    .block-content {
      color: #666;
      line-height: 1.8;
    }
    
    .block-content ul {
      margin: 8px 0;
      padding-left: 24px;
    }
    
    .block-content li {
      margin: 6px 0;
    }
    
    .block-content p {
      margin: 8px 0;
      line-height: 1.8;
    }
    
    /* å—å†…å°æ ‡é¢˜æ ·å¼ */
    .block-subtitle {
      font-size: 16px;
      font-weight: 600;
      color: #2c3e50;
      margin: 16px 0 10px 0;
      padding-left: 12px;
      border-left: 3px solid #e0e0e0;
      line-height: 1.6;
    }
    
    /* è¡¨æ ¼æ ·å¼ - ç°ä»£åŒ–è®¾è®¡ */
    .content-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin: 24px 0;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      border: 1px solid #e8e8e8;
    }
    
    .content-table th,
    .content-table td {
      padding: 16px 20px;
      text-align: left;
      border: none;
    }
    
    .content-table thead {
      position: relative;
    }
    
    .content-table th {
      background: linear-gradient(135deg, #f0f4ff 0%, #e8f0fe 100%);
      font-weight: 600;
      color: #2c3e50;
      font-size: 15px;
      letter-spacing: 0.3px;
      position: relative;
      border-bottom: 2px solid #d0e0ff;
    }
    
    .content-table th:first-child {
      border-top-left-radius: 12px;
    }
    
    .content-table th:last-child {
      border-top-right-radius: 12px;
    }
    
    .content-table tbody tr {
      transition: all 0.3s ease;
      border-bottom: 1px solid #f0f0f0;
    }
    
    .content-table tbody tr:last-child {
      border-bottom: none;
    }
    
    .content-table tbody tr:nth-child(odd) {
      background: linear-gradient(90deg, #fafbfc 0%, #ffffff 100%);
    }
    
    .content-table tbody tr:nth-child(even) {
      background: white;
    }
    
    .content-table tbody tr:hover {
      background: linear-gradient(90deg, #f5f8ff 0%, #f0f7ff 100%);
      transform: scale(1.005);
      box-shadow: 0 2px 8px rgba(90, 123, 166, 0.12);
    }
    
    .content-table td {
      color: #333;
      font-size: 14px;
      line-height: 1.6;
    }
    
    .content-table td:first-child {
      font-weight: 600;
      color: #5a7ba6;
    }
    
    /* è¡¨æ ¼ä¸­çš„ç®­å¤´ç¬¦å·ç¾åŒ– */
    .content-table td:contains("â†’") {
      font-weight: 500;
    }
    
    /* æ ‡ç­¾æ ·å¼ - ç²¾è‡´è®¾è®¡ */
    .tag-badge {
      display: inline-block;
      padding: 4px 12px;
      background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
      color: #e65100;
      border-radius: 6px;
      font-size: 13px;
      margin: 0 6px;
      font-weight: 600;
      border: 1px solid #ffb74d;
      box-shadow: 0 2px 4px rgba(230, 81, 0, 0.1);
      transition: all 0.2s ease;
    }
    
    .tag-badge:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(230, 81, 0, 0.2);
    }
    
    .time-badge {
      display: inline-block;
      padding: 5px 14px;
      background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
      color: #1b5e20;
      border-radius: 6px;
      font-size: 13px;
      margin: 4px;
      font-weight: 600;
      border: 1px solid #81c784;
      box-shadow: 0 2px 4px rgba(27, 94, 32, 0.1);
      transition: all 0.2s ease;
    }
    
    .time-badge:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(27, 94, 32, 0.2);
    }
    
    .text-highlight {
      color: #667eea;
      font-weight: 600;
      text-shadow: 0 1px 2px rgba(102, 126, 234, 0.1);
    }
  </style>
</head>
<body>
  <div class="test-section">
    <h2>æµ‹è¯• Content Formatter</h2>
    <p>è¾“å…¥å¸¦ emoji æ ‡è®°çš„å†…å®¹ï¼Œæµ‹è¯•æ ¼å¼åŒ–æ•ˆæœï¼š</p>
    
    <textarea class="input-text" id="input">## ä¸€ã€è´¦å·è¯Šæ–­ä¸å®šä½

### 1.1 è´¦å·ä¼˜åŠ¿åˆ†æ

âœ… æ ¸å¿ƒä¼˜åŠ¿

- å†…å®¹å®šä½æ¸…æ™°ï¼Œä¸“æ³¨ç¾å¦†é¢†åŸŸ
- å·²æœ‰å†…å®¹ç§¯ç´¯ï¼Œå¯ä»¥ä¼˜åŒ–è¿­ä»£
- èµ·å·é˜¶æ®µï¼Œå¢é•¿ç©ºé—´å¤§

âš ï¸ éœ€è¦æ”¹è¿›

- ç²‰ä¸åŸºæ•°è¾ƒä½ï¼Œéœ€è¦å†·å¯åŠ¨ç­–ç•¥
- å†…å®¹æ›å…‰åº¦ä¸è¶³
- äº’åŠ¨ç‡éœ€è¦æå‡

### 1.2 æ¶¨ç²‰è®¡åˆ’æ€»ç»“

| é˜¶æ®µ | æ—¶é—´å‘¨æœŸ | æ ¸å¿ƒåŠ¨ä½œ | ç›®æ ‡ç²‰ä¸æ•° |
|------|---------|---------|-----------|
| 1. èµ·æ­¥æœŸ | ç¬¬1å‘¨ - ç¬¬4å‘¨ | ç²¾å‡†å®šä½ä¸è£…ä¿®ã€å»ºç«‹å†…å®¹åŸºå‡†çº¿ | 0 â†’ 500 |
| 2. æˆé•¿æœŸ | ç¬¬5å‘¨ - ç¬¬12å‘¨ | æ•°æ®å¤ç›˜ä¸ä¼˜åŒ–ã€å»ºç«‹å†…å®¹æ ç›® | 500 â†’ 3000 |
| 3. åŠ é€ŸæœŸ | ç¬¬13å‘¨ - ç¬¬24å‘¨ | å†²å‡»å°çˆ†æ¬¾ã€çŸ©é˜µå¼å†…å®¹å¸ƒå±€ | 3000 â†’ 10000 |

ğŸ’¡ æ¶¨ç²‰é¢„æœŸ

#### éš¾åº¦ç­‰çº§
ä¸­ç­‰éš¾åº¦ï¼Œéœ€è¦æŒç»­æŠ•å…¥

#### é¢„è®¡æ—¶é—´
4-6å‘¨è¾¾åˆ°ç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘

#### å…³é”®æˆåŠŸå› ç´ 
- ç¬¬ä¸€å‘¨ï¼šå®Œæˆè´¦å·è£…ä¿®å’Œå®šä½
- ç¬¬äºŒå‘¨ï¼šå‘å¸ƒ10-15ç¯‡é«˜è´¨é‡ç¬”è®°
- ç¬¬ä¸‰å‘¨ï¼šæ•°æ®åˆ†æå’Œå†…å®¹ä¼˜åŒ–</textarea>
    
    <button onclick="testFormat()">æ ¼å¼åŒ–</button>
    
    <div class="output" id="output"></div>
  </div>
  
  <script>
    // å®Œæ•´çš„æ ¼å¼åŒ–å‡½æ•°
    function formatContent(content) {
      if (!content) return '<p style="color: #999;">å†…å®¹ä¸ºç©º</p>';
      
      let formatted = content;
      
      // 1. å¤„ç† Markdown æ ‡é¢˜
      formatted = formatted.replace(/^#### (.+)$/gm, '<h4 class="content-h4">$1</h4>');
      formatted = formatted.replace(/^### (.+)$/gm, '<h3 class="content-h3">$1</h3>');
      formatted = formatted.replace(/^## (.+)$/gm, '<h2 class="content-h2">$1</h2>');
      
      // 2. è§£æå†…å®¹å—
      const { rawHtml } = parseContentBlocks(formatted);
      if (rawHtml) {
        formatted = rawHtml;
      }
      
      // 3. å¤„ç†ã€ã€‘æ‹¬å·å†…å®¹
      formatted = formatted.replace(/ã€(.+?)ã€‘/g, '<span class="tag-badge">$1</span>');
      
      // 4. å¤„ç†åŠ ç²—
      formatted = formatted.replace(/\*\*(.+?)\*\*/g, '<strong class="text-highlight">$1</strong>');
      
      // 5. å¤„ç†è¡¨æ ¼
      formatted = formatTables(formatted);
      
      // 6. å¤„ç†æ—¶é—´æ ¼å¼
      formatted = formatted.replace(/(\d{1,2}:\d{2}-\d{1,2}:\d{2})\s+(\d{1,2}:\d{2}-\d{1,2}:\d{2})/g, 
        '<span class="time-badge">$1</span> <span class="time-badge">$2</span>');
      
      return formatted;
    }
    
    function parseContentBlocks(content) {
      const lines = content.split('\n').map(line => line.trim()).filter(line => line);
      const blocks = [];
      let currentBlock = null;
      let result = [];
      
      for (const line of lines) {
        // è·³è¿‡å·²ç»æ˜¯HTMLæ ‡ç­¾çš„è¡Œ
        if (line.startsWith('<h2') || line.startsWith('<h3') || line.startsWith('<h4')) {
          if (currentBlock) {
            blocks.push(currentBlock);
            currentBlock = null;
          }
          result.push(line);
          continue;
        }
        
        // ä½¿ç”¨ Unicode å±æ€§åŒ¹é… emoji
        const blockMatch = line.match(/^([\u{1F300}-\u{1F9FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}][\uFE00-\uFE0F]?)\s*(.+)$/u);
        
        if (blockMatch) {
          if (currentBlock) {
            blocks.push(currentBlock);
          }
          
          const icon = blockMatch[1];
          const title = blockMatch[2];
          
          let type = 'default';
          if (icon.includes('âœ…')) type = 'success';
          else if (icon.includes('âš ')) type = 'warning';
          else if (icon.includes('ğŸ’¡')) type = 'info';
          
          currentBlock = {
            type,
            title,
            content: [],
            icon
          };
        } else if (currentBlock) {
          currentBlock.content.push(line);
        } else {
          result.push(line);
        }
      }
      
      if (currentBlock) {
        blocks.push(currentBlock);
      }
      
      const blocksHtml = generateBlocksHtml(blocks);
      const rawHtml = result.join('\n') + '\n' + blocksHtml;
      
      return { blocks, rawHtml };
    }
    
    function generateBlocksHtml(blocks) {
      return blocks.map(block => {
        const className = `content-block ${block.type}-block`;
        let inList = false;
        const contentHtml = [];
        
        block.content.forEach(line => {
          const listMatch = line.match(/^[â€¢\-]\s(.+)$/);
          const numberMatch = line.match(/^\d+\.\s(.+)$/);
          
          if (listMatch || numberMatch) {
            const text = listMatch ? listMatch[1] : numberMatch[1];
            
            // åˆ¤æ–­æ˜¯å¦æ˜¯å°æ ‡é¢˜
            const isTimeSubtitle = /^(ç¬¬[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å\d]+[å‘¨å¤©æ—¥]|Day\s*\d+|æ—©ä¸Š|ä¸Šåˆ|ä¸­åˆ|ä¸‹åˆ|æ™šä¸Š|å¤œé—´)/i.test(text);
            const isKeywordColon = /^[\u4e00-\u9fa5]{1,6}[ï¼š:]\s*/.test(text) && text.length <= 30;
            
            if (isTimeSubtitle || isKeywordColon) {
              if (inList) {
                contentHtml.push('</ul>');
                inList = false;
              }
              
              let formattedText = text;
              if (isKeywordColon) {
                formattedText = text.replace(/^([\u4e00-\u9fa5]{1,6}[ï¼š:])/, '<strong>$1</strong>');
              }
              
              contentHtml.push(`<h4 class="block-subtitle">${formattedText}</h4>`);
            } else {
              if (!inList) {
                contentHtml.push('<ul>');
                inList = true;
              }
              contentHtml.push(`<li>${text}</li>`);
            }
          } else {
            if (inList) {
              contentHtml.push('</ul>');
              inList = false;
            }
            contentHtml.push(`<p>${line}</p>`);
          }
        });
        
        if (inList) {
          contentHtml.push('</ul>');
        }
        
        return `
          <div class="${className}">
            <div class="block-header">
              <span class="block-icon">${block.icon}</span>
              <span class="block-title">${block.title}</span>
            </div>
            <div class="block-content">
              ${contentHtml.join('\n')}
            </div>
          </div>
        `;
      }).join('\n');
    }
    
    function formatTables(content) {
      const tableRegex = /^\|(.+)\|$/gm;
      if (!tableRegex.test(content)) {
        return content;
      }
      
      return content.replace(/(\|.+\|\n)+/g, (match) => {
        const rows = match.trim().split('\n');
        if (rows.length < 2) return match;
        
        let tableHtml = '<table class="content-table">';
        
        rows.forEach((row, index) => {
          const cells = row.split('|').filter(cell => cell.trim()).map(cell => cell.trim());
          if (cells.length === 0) return;
          
          // è·³è¿‡åˆ†éš”è¡Œ
          if (cells[0].match(/^-+$/)) return;
          
          const tag = index === 0 ? 'th' : 'td';
          tableHtml += '<tr>';
          cells.forEach(cell => {
            tableHtml += `<${tag}>${cell}</${tag}>`;
          });
          tableHtml += '</tr>';
        });
        
        tableHtml += '</table>';
        return tableHtml;
      });
    }
    
    function testFormat() {
      const input = document.getElementById('input').value;
      const html = formatContent(input);
      document.getElementById('output').innerHTML = html;
      
      console.log('=== æ ¼å¼åŒ–ç»“æœ ===');
      console.log(html);
    }
    
    // è‡ªåŠ¨æµ‹è¯•
    testFormat();
  </script>
</body>
</html>
