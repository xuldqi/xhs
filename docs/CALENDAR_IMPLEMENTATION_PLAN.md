# AI 内容日历 - 实现计划

> 目标：以「AI 生成为主、用户手动微调为辅」的混合模式，解决创作者「没思路、不知道发什么、什么时候发、怎么保持一致性」的痛点。

---

## 一、当前实现 vs 目标

| 能力 | 当前状态 | 目标状态 |
|------|----------|----------|
| AI 生成 | ✅ 已有（表单输入定位/目标/风格，调用 API 生成 7/30 天） | 增强：支持从诊断结果自动填充参数 |
| 日历展示 | ✅ 已有（网格展示、单日详情抽屉） | 增强：拖拽换天、批量操作、状态标记 |
| 手动编辑 | ⚠️ 部分（只能查看，不能改） | 完整：标题/大纲/标签可编辑，拖拽调日期 |
| 导出 | ✅ 已有（Markdown、PDF） | 保持 |
| 云端保存 | ✅ 已有（登录后保存） | 保持；生成后自动写入列表 |
| 列表页 | ❌ 无 | 新增：我的日历列表，按规划展示 |
| 默认页 | ❌ 无 | 新增：默认展示最近一次，可切换 |
| 月历布局 | ⚠️ 网格展示 | 改为月视图：日期 + 星期 + 内容 |
| 诊断联动 | ❌ 无 | 新增：诊断完成后一键跳转并预填 |
| 发布时间建议 | ⚠️ 已有字段，是否智能？ | 增强：基于平台高峰期 + 用户历史 |
| 迭代闭环 | ❌ 无 | 新增：发完后输入链接 → AI 分析 → 优化下周 |
| 免费 / VIP 差异化 | ✅ 已有（7 天免费，30 天 VIP） | 增强：迭代学习、历史日历为 VIP 卖点 |

---

## 二、分阶段实施计划

### 阶段一：诊断联动 + 参数预填（P0）

**目标**：用户做完账号诊断后，可一键生成日历，减少重复填写。

| 任务 | 说明 | 预估 |
|------|------|------|
| 1.1 | 诊断报告页增加「生成内容日历」CTA，跳转 `/calendar?from=guide` 并带上 `guideId` | 0.5d |
| 1.2 | `CalendarView` 解析 `guideId` 或 `shareId`，调用接口获取诊断摘要（定位/风格/目标） | 0.5d |
| 1.3 | 预填表单：`positioning`、`goal`、`styleKeywords`、`referenceNotes` 等 | 0.5d |
| 1.4 | 首页/分析页：未诊断用户引导「先诊断再生成日历」 | 0.5d |

**产出**：诊断 → 日历 链路打通，参数自动带入。✅ 已完成

---

### 阶段二：列表页 + 默认页 + 月历布局（P0）

**目标**：生成后自动保存；下次进入展示「我的日历」列表；默认打开最近一次；日历以月视图展示（日期 + 星期）。

| 任务 | 说明 | 预估 |
|------|------|------|
| 2.1 | 生成后自动保存到 `calendar_history`（已有），确保每次生成都写入 | 0.5d |
| 2.2 | **列表页**：进入 `/calendar` 时，若有历史则展示「我的日历」列表；按规划维度展示卡片（定位 + 目标 + 生成时间） | 1d |
| 2.3 | **默认页**：默认选中并展示「最近一次生成的日历」；顶部或侧边提供「切换规划」入口 | 1d |
| 2.4 | **月历布局**：改用月视图展示，每格含日期、星期、当日内容摘要；支持左右翻月 | 1.5d |
| 2.5 | **新建**：列表页 / 日历页提供「新建日历」入口，跳回生成表单 | 0.5d |

**产出**：列表 → 选中日历 → 月历展示；默认最近一条；支持切换不同规划。

---

### 阶段三：手动编辑 + 拖拽（P0）

**目标**：生成后用户可微调，提升粘性。

| 任务 | 说明 | 预估 |
|------|------|------|
| 3.1 | 单日详情抽屉：标题、大纲、标签支持内联编辑 | 1d |
| 3.2 | 单条笔记：新增「拖拽换天」能力（vue-cal / 自定义拖拽） | 1d |
| 3.3 | 单条笔记：状态标记（草稿 / 已发 / 待发） | 0.5d |
| 3.4 | 批量操作：复制到下周、一键替换风格（调 API 重新生成局部） | 1d |
| 3.5 | 空白模板：提供「从零填写」入口，默认仍引导 AI 生成 | 0.5d |

**产出**：日历可编辑、可拖拽、可批量操作。✅ 已完成

---

### 阶段四：发布时间智能建议（P1）

**目标**：每条笔记带「建议发布时间」，基于平台规律 + 用户历史。

| 任务 | 说明 | 预估 |
|------|------|------|
| 4.1 | 后端：日历生成时融入「发布时间预测」逻辑（平台高峰期 + 用户历史） | 1d |
| 4.2 | 前端：`CalendarItem` 展示 `suggestedTime`，支持用户修改 | 0.5d |
| 4.3 | 可选：接入用户历史发帖时间，做个性化推荐 | 0.5d |

**产出**：每条笔记有建议发布时间，用户可改。✅ 已完成

---

### 阶段五：迭代闭环（P1，VIP 核心卖点）

**目标**：发完笔记后输入链接/数据 → AI 分析表现 → 自动优化下周/下月日历。

| 任务 | 说明 | 预估 |
|------|------|------|
| 5.1 | 日历单条：增加「标记已发」+ 填写笔记链接/简要数据（点赞/收藏/评论） | 1d |
| 5.2 | 后端：`/api/calendar/analyze` 分析单条表现，返回优化建议 | 1d |
| 5.3 | 后端：`/api/calendar/optimize` 基于历史数据优化下周/下月日历 | 1.5d |
| 5.4 | 前端：「优化下周」按钮，调用 optimize API，局部刷新日历 | 1d |
| 5.5 | 权限：免费版只生成基础日历；VIP 支持迭代 + 历史学习 | 0.5d |

**产出**：发完 → 录入数据 → AI 分析 → 一键优化，VIP 专属。✅ 已完成

---

### 阶段六：体验与差异化（P2）

**目标**：打磨体验，强化 VIP 价值。

| 任务 | 说明 | 预估 |
|------|------|------|
| 6.1 | 列表页增强：支持对比、复制到新日历 | 0.5d |
| 6.2 | 品牌声：支持多套，生成时可选择 | 0.5d |
| 6.3 | 内容类型：确保图文/短视频/轮播/直播预告多样化 | 0.5d |
| 6.4 | 引导文案：默认强引导「先 AI 生成」，弱化手动填写 | 0.5d |

**产出**：体验更顺，VIP 功能更清晰。✅ 已完成

---

## 三、依赖与前置

- **后端**：`/api/calendar/generate` 已存在，需确认返回结构是否含 `suggestedTime`、`type` 等
- **诊断**：需有接口可根据 `guideId`/`shareId` 获取诊断摘要
- **数据库**：`calendar_history`、`brand_voice` 已有；迭代闭环可能需新增 `note_performance` 等表

---

## 四、建议落地顺序

1. **阶段一**（诊断联动）— ✅ 已完成
2. **阶段二**（列表页 + 默认页 + 月历布局）— 优先：保存、列表、月历格式
3. **阶段三**（手动编辑 + 拖拽）— 提升日常使用频率
4. **阶段四**（发布时间）— 增强专业感
5. **阶段五**（迭代闭环）— VIP 核心卖点，可分批上线
6. **阶段六**（体验）— 持续优化

---

## 五、风险与简化

- **迭代闭环**实现成本较高，可先做「标记已发 + 手动输入数据」，AI 优化稍后
- **拖拽**若接入 vue-cal 等库，需评估与现有网格布局的兼容
- **诊断联动**若暂无 `guideId` 接口，可先用 URL 参数手传关键字段

---

*文档更新：基于产品方向「AI 生成为主、手动微调为辅、迭代闭环为 VIP 卖点」整理。*
